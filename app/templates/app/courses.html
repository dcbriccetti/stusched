{% extends "app/base.html" %}
{% load vars %}
{% load bootstrap3 %}

{% block title %}{{ block.super }} - Courses{% endblock %}

{% block content %}
<h2>Courses</h2>
{% if courses %}
    {% if user.is_authenticated %}
        <p>If you make any changes, push the Save Changes button below.</p>
    {% else %}
        <p><a href="{% url 'login' %}?next=courses">Log in</a> to see and change your childrenâ€™s course interest settings here. (Or change them from the Students page.)</p>
    {% endif %}
    <form method="post">
        {% csrf_token %}
        <table class="table table-nonfluid">
        <thead>
        <tr>
            <th>Course Name</th>
            <th colspan="{{ student_wants|length|add:"1" }}">Students Interested</th>
        </tr>
        <tr>
            <th></th>
            <th>All</th>
            {% for student_want in student_wants %}
            <th>{{ student_want.student.name }}</th>
            {% endfor %}
        </tr>
        </thead>
        <tbody>
        {% for course in courses %}
            <tr>
            <td>
            {% if course.url %}
            <a href={{ course.url }}>{{ course.name }}</a>
            {% else %}
            {{ course.name }}
            {% endif %}
            </td>
            <td>{{ want_by_course|get_item:course.id }}</td>
            {% for student_want in student_wants %}
            <td>
                <input name="want-{{ student_want.student.id }}-{{ course.id }}" type="checkbox"
                {% if course.id in student_want.course_ids %}
                    checked
                {% endif %}
                />
            </td>
            {% endfor %}
            </tr>
        {% endfor %}
        </tbody>
        </table>
        {% buttons %}
            <button type="submit" class="btn btn-primary">Save Changes</button>
        {% endbuttons %}
    </form>
{% else %}
    <p>No courses are available.</p>
{% endif %}
    <h3>Suggest a Course</h3>
    <p>Have a suggestion for a course?
        Please <a href="mailto:daveb@davebsoft.com?subject=Course%20suggestion">send it.</a></p>
{% endblock %}
