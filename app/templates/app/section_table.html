{% load relationships %}

<table class="table">
    <thead>
    <tr>
        <th></th>
        <th>Course</th>
        <th>Status</th>
        <th>Price</th>
        <th>Start Time</th>
        <th>Hours / Day</th>
        <th># Days</th>
        <th title="Minumum, enrolled, and maximum number of students">Students</th>
        {% if user.is_staff %}
        <th>Names</th>
        {% endif %}
        {% if students_of_user and user.is_authenticated and not user.is_staff %}
        <th>Your Students</th>
        {% endif %}
        <th>Notes</th>
    </tr>
    </thead>
    <tbody>
    {% for section in sections %}
        <tr>
            <td>
                {% if user.is_staff or section.id in viewable_section_ids %}
                <a href='/app/section/{{ section.id }}'><span class="glyphicon glyphicon-eye-open" title="View section details"></span></a>
                {% endif %}

                {% if section.registration_open and user.is_authenticated %}
                    <a title='Change Registration'
                       class='btn btn-primary btn-xs' role="button" href='/app/section/{{ section.id }}/register'>Reg</a>
                {% endif %}
            </td>
            <td>
                {% if section.course.url %}
                    <a href={{ section.course.url }}>{{ section.course.name }}</a>
                {% else %}
                    {{ section.course.name }}
                {% endif %}
            </td>
            <td>{{ section.scheduled_status_string }}</td>
            <td>
                {% if section.price %}
                ${{ section.price }}
                {% endif %}
            </td>
            <td>{{ section.start_time }}</td>
            <td>{{ section.hours_per_day_formatted }}</td>
            <td>{{ section.num_days }}</td>
            <td>
                <span class='text-muted' style="font-size: 70%">{{ section.min_students }} ≤ </span>
                <span
                    {% if section.num_students >= section.min_students and section.num_students <= section.max_students %}
                    class="text-success"
                    {% else %}
                    class="text-danger"
                    {% endif %}
                >
                {{ section.num_students }}
                </span>
                <span class='text-muted' style="font-size: 70%"> ≤ {{ section.max_students }}</span>
            </td>
            {% if user.is_staff %}
            <td>{{ section.students }}</td>
            {% endif %}
            {% if students_of_user and user.is_authenticated and not user.is_staff %}
            <td>{{ section.student_objects|students_intersection:students_of_user }}</td>
            {% endif %}
            <td>{{ section.notes }}</td>
        </tr>
    {% endfor %}
    </tbody>
</table>
